compilers:
- compiler:
    # GCC 6.2.0 is the main compiler we use and it is not installed in /usr so
    # we need to add rpaths to this GCC's libraries
    extra_rpaths:
     - /nopt/nrel/apps/gcc/6.2.0/lib64 
     - /nopt/nrel/apps/gcc/6.2.0/libexec/gcc/x86_64-linux-gnu/6.2.0 
     - /nopt/nrel/apps/gcc/6.2.0/lib/gcc/x86_64-linux-gnu/6.2.0 
    flags:
      cflags: -O2
      cxxflags: -O2
      fflags: -O2
      fcflags: -O2
    modules: []
    operating_system: centos7
    paths:
      cc: /nopt/nrel/apps/gcc/6.2.0/bin/gcc
      cxx: /nopt/nrel/apps/gcc/6.2.0/bin/g++
      f77: /nopt/nrel/apps/gcc/6.2.0/bin/gfortran
      fc: /nopt/nrel/apps/gcc/6.2.0/bin/gfortran
    spec: gcc@6.2.0
    target: x86_64
- compiler:
    environment:
      # NREL uses a license server for the Intel compiler
      set:
        INTEL_LICENSE_FILE: 28518@hpc-admin1.hpc.nrel.gov
    # We usually have GCC 6.2.0 loaded when using the Intel compiler
    # so we rpath to the GCC's libraries as well, but even though this has been
    # working fine, I am not sure this is necessary, or even a good idea
    extra_rpaths:
     - /nopt/nrel/apps/gcc/6.2.0/lib64 
     - /nopt/nrel/apps/gcc/6.2.0/libexec/gcc/x86_64-linux-gnu/6.2.0 
     - /nopt/nrel/apps/gcc/6.2.0/lib/gcc/x86_64-linux-gnu/6.2.0 
     - /nopt/nrel/ecom/ecp/base/a/spack/opt/spack/linux-centos7-x86_64/gcc-6.2.0/intel-parallel-studio-cluster.2018.1-55fqnorv74jgznpbk4gey7jpfh4o7iwb/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64
    # Peregrine is a heterogenous system with Ivybridge and Haswell nodes 
    # so we use automatic CPU dispatch with -axCORE-AVX2,CORE-AVX-I for Intel
    # to try to get good vectorization for each type of node
    flags:
      cflags: -O2 -axCORE-AVX2,CORE-AVX-I
      cxxflags: -O2 -axCORE-AVX2,CORE-AVX-I
      fflags: -O2 -axCORE-AVX2,CORE-AVX-I
      fcflags: -O2 -axCORE-AVX2,CORE-AVX-I
    modules: []
    operating_system: centos7
    # The Intel compiler is installed using Spack and we regularly update all the
    # software built with Spack on the machine using an A and B installation where
    # we symlink to the "active" set of software A or B, and the administrator can then
    # update the inactive set of software before making it active.
    # Therefore these paths will regularly change.
    paths:
      cc: /nopt/nrel/ecom/ecp/base/a/spack/opt/spack/linux-centos7-x86_64/gcc-6.2.0/intel-parallel-studio-cluster.2018.1-55fqnorv74jgznpbk4gey7jpfh4o7iwb/compilers_and_libraries_2018.1.163/linux/bin/intel64/icc
      cxx: /nopt/nrel/ecom/ecp/base/a/spack/opt/spack/linux-centos7-x86_64/gcc-6.2.0/intel-parallel-studio-cluster.2018.1-55fqnorv74jgznpbk4gey7jpfh4o7iwb/compilers_and_libraries_2018.1.163/linux/bin/intel64/icpc
      f77: /nopt/nrel/ecom/ecp/base/a/spack/opt/spack/linux-centos7-x86_64/gcc-6.2.0/intel-parallel-studio-cluster.2018.1-55fqnorv74jgznpbk4gey7jpfh4o7iwb/compilers_and_libraries_2018.1.163/linux/bin/intel64/ifort
      fc: /nopt/nrel/ecom/ecp/base/a/spack/opt/spack/linux-centos7-x86_64/gcc-6.2.0/intel-parallel-studio-cluster.2018.1-55fqnorv74jgznpbk4gey7jpfh4o7iwb/compilers_and_libraries_2018.1.163/linux/bin/intel64/ifort
    spec: intel@18.1.163
    target: x86_64
